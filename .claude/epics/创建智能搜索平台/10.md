---
id: 001
title: Spring Boot平台搭建
epic: 创建智能搜索平台
status: closed
priority: high
assignee: ""
labels: ["基础架构", "spring-boot", "数据库"]
created: 2025-09-20T02:23:58Z
updated: 2025-09-20T04:46:48Z
estimate: L
parallel: false
dependencies: []
---

# Spring Boot平台搭建

## 描述

搭建智能搜索平台的Spring Boot基础架构，包括单体应用框架、MySQL数据库设计、核心依赖配置和基础服务层。使用Maven作为构建工具，移除所有Gradle相关文件和配置。这是整个搜索平台的技术基石，为后续的向量处理和搜索功能提供稳定的运行环境。

## 验收标准

- [ ] Spring Boot 3.x应用正常启动，监听端口8080
- [ ] MySQL数据库连接池配置完成，支持事务管理
- [ ] 实现基础的CRUD操作API（用户、文档、搜索记录）
- [ ] 集成Spring Security，实现JWT认证机制
- [ ] 配置Swagger/OpenAPI文档，API接口可视化
- [ ] 单元测试覆盖率达到80%以上
- [ ] Docker容器化部署成功
- [ ] 健康检查端点(/actuator/health)正常响应
- [ ] 项目使用Maven构建，所有Gradle文件已移除

## 技术细节

### 核心技术栈
- Spring Boot 3.2+
- Spring Data JPA
- Spring Security 6.x
- MySQL 8.0+
- Maven构建工具
- Docker

### 数据库设计
```sql
-- 用户表
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('USER', 'ADMIN') DEFAULT 'USER',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 文档表
CREATE TABLE documents (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    content TEXT NOT NULL,
    file_path VARCHAR(500),
    file_type VARCHAR(50),
    file_size BIGINT,
    status ENUM('PENDING', 'PROCESSING', 'INDEXED', 'ERROR') DEFAULT 'PENDING',
    user_id BIGINT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- 搜索记录表
CREATE TABLE search_logs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    query_text VARCHAR(1000) NOT NULL,
    user_id BIGINT,
    search_type ENUM('KEYWORD', 'SEMANTIC', 'HYBRID') NOT NULL,
    result_count INT DEFAULT 0,
    response_time_ms INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### 项目结构
```
src/main/java/com/deepsearch/
├── DeepSearchApplication.java
├── config/
│   ├── DatabaseConfig.java
│   ├── SecurityConfig.java
│   └── SwaggerConfig.java
├── controller/
│   ├── UserController.java
│   ├── DocumentController.java
│   └── SearchController.java
├── service/
│   ├── UserService.java
│   ├── DocumentService.java
│   └── SearchService.java
├── repository/
│   ├── UserRepository.java
│   ├── DocumentRepository.java
│   └── SearchLogRepository.java
├── entity/
│   ├── User.java
│   ├── Document.java
│   └── SearchLog.java
├── dto/
│   ├── UserDto.java
│   ├── DocumentDto.java
│   └── SearchDto.java
└── exception/
    ├── GlobalExceptionHandler.java
    └── CustomExceptions.java
```

### 关键配置

**application.yml**
```yaml
server:
  port: 8080

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/deep_search?useSSL=false&serverTimezone=UTC
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:password}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true

  security:
    jwt:
      secret: ${JWT_SECRET:defaultSecret}
      expiration: 86400

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
```

## 依赖关系

**前置依赖**: 无

**后续任务依赖此任务**:
- 002: 双模式向量处理引擎
- 003: Elasticsearch搜索引擎集成

## 工作量估算

**规模**: L (大型)
**预估时间**: 3-4周
**并行性**: false (关键路径)

### 分解任务
1. 项目初始化和Maven配置，移除Gradle文件 (3天)
2. 数据库设计和JPA实体映射 (4天)
3. 基础CRUD服务实现 (5天)
4. Security和JWT认证 (4天)
5. API接口开发 (3天)
6. 单元测试编写 (3天)
7. Docker容器化 (2天)
8. 文档和部署验证 (2天)

## 完成定义

任务完成需满足以下条件：
1. 所有验收标准项目通过
2. 代码审查通过，符合团队编码规范
3. 性能测试通过（支持并发100用户）
4. 安全扫描无高危漏洞
5. 部署到测试环境成功运行

## 风险与缓解

**技术风险**:
- Spring Boot版本兼容性 → 使用LTS版本，提前验证依赖
- 数据库性能问题 → 合理设计索引，使用连接池

**时间风险**:
- JWT安全配置复杂 → 参考最佳实践，预留缓冲时间
